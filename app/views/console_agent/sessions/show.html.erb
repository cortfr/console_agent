<a href="<%= console_agent.sessions_path %>" class="back-link">&larr; Back to sessions</a>

<div class="meta-card">
  <div class="meta-grid">
    <div class="meta-item">
      <label>Query</label>
      <span><%= @session.query %></span>
    </div>
    <% if @session.name.present? %>
      <div class="meta-item">
        <label>Name</label>
        <span><%= @session.name %></span>
      </div>
    <% end %>
    <div class="meta-item">
      <label>Mode</label>
      <span class="badge badge-<%= @session.mode %>"><%= @session.mode %></span>
    </div>
    <div class="meta-item">
      <label>User</label>
      <span><%= @session.user_name || '-' %></span>
    </div>
    <div class="meta-item">
      <label>Provider / Model</label>
      <span><%= @session.provider %> / <%= @session.model %></span>
    </div>
    <div class="meta-item">
      <label>Tokens (in / out)</label>
      <span class="mono"><%= @session.input_tokens %> / <%= @session.output_tokens %></span>
    </div>
    <div class="meta-item">
      <label>Duration</label>
      <span class="mono"><%= @session.duration_ms ? "#{@session.duration_ms}ms" : '-' %></span>
    </div>
    <div class="meta-item">
      <label>Executed?</label>
      <span><%= @session.executed? ? '<span class="check">Yes</span>'.html_safe : '<span class="cross">No</span>'.html_safe %></span>
    </div>
    <div class="meta-item">
      <label>Time</label>
      <span><%= @session.created_at.strftime('%Y-%m-%d %H:%M:%S') %></span>
    </div>
  </div>
</div>

<h3 style="font-size: 16px; margin-bottom: 12px;">Console Output</h3>

<% if @session.console_output.present? %>
  <div class="terminal">
    <pre><%= ansi_to_html(@session.console_output) %></pre>
  </div>
<% else %>
  <div class="meta-card">
    <p class="text-muted">No console output recorded for this session.</p>
  </div>
<% end %>
